---
sidebar_position: 3
id: makeraw
title: 在 <script setup> 下使用 <component :is>
tags:
  - Vue3
  - Composition API
draft: false
---

# 在 `<script setup>` 下使用 `<component :is>`

## 前提

專案結構在使用 Composition API `<script setup>` 的寫法，在某個 Component 的切換想要搭配 `<Transition>`，進而達成切換 Component 的時候產生轉場動畫。

不過，這個原本在 Options API 可正常運作的寫法，改成 `<script setup>` 後便無法正常動作，於是開始進行排解。


```js
<script setup>
import { ref, markRaw, computed } from 'vue'
import Card from './Card.vue'
import Card1 from './Card1.vue'

const toggleArrow = ref(false)
const activeCard = ref(null)

cardFlip()
function cardFlip() {
  if (activeCard.value === BingoCard) {
    activeCard.value = markRaw(Card)
  } else {
    activeCard.value = markRaw(BingoCard)
  }
}
</script>
<template>
  ...
  <Transition name="fade" mode="out-in">
    <component :is="activeCard"></component>
  </Transition>
  
</template>
```




## 解決方案


父元件：

```js
  <Header
    :bg-color="'--primary-200'"
  />
```

子元件(Header.vue)：

```js
<script setup>
const props = defineProps({
  bgColor: { type: String, required: false, default: '--secondary-900' },
})
</script>

<template>
  <div class="header" :style="`--header-bg-color: var(${props.bgColor})`"></div>
</template>

<style scoped>
.header {
  width: 200px;
  height: 80px;
  // --header-bg-color 為欲指定的顏色，#000000 為找不到前者之預設顏色
  background: var(--header-bg-color, #000000);
}
</style>
```

## 心得

因為在新專案中全面使用 `<script setup>`，導致之前在 Options API 正常使用的寫法會有些出入、甚至無法正常運作，像是 `<component :is>` 就算是其中一個實例。

原本以為是自己不熟悉用法還是邏輯有問題，比對官方文件翻找了半天，才發現要用 `<makeraw>`方能正常運作，而且網路上討論度也不太高，算是剛好踩到這個坑，順手記錄起來提醒自己。

## 參考資料

- https://vuejs.org/guide/essentials/component-basics.html#dynamic-components
- https://vuejs.org/guide/built-ins/transition.html#transition-between-components
- https://vuejs.org/api/reactivity-advanced.html#markraw
- https://stackoverflow.com/questions/66384268/how-to-use-component-is-in-vue-3-script-setup
